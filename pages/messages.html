<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–æ–±—â–µ–Ω–∏—è</title>
    <link rel="stylesheet" href="../style/style.css">
</head>
<body>
    <header>
        <nav>
            <ul class="nav-menu">
                <li><a href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="gallery.html">–§–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è</a></li>
                <li><a href="register.html">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
                <li><a href="messages.html">–°–æ–æ–±—â–µ–Ω–∏—è</a></li>
                <li><a href="test.html">–¢–µ—Å—Ç</a></li>
                <li><a href="conference.html">–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è</a></li>
                <li><a href="conference-participants.html">–£—á–∞—Å—Ç–Ω–∏–∫–∏</a></li>
                <li id="auth-status">
                    <span id="user-name"></span>
                    <button id="logout-btn" style="display:none;">–í—ã–π—Ç–∏</button>
                </li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <div id="auth-check" style="display: none;">
            <div class="protected-message">
                <h2>–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω</h2>
                <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
                <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="register.html">–≤–æ–π–¥–∏—Ç–µ</a> –∏–ª–∏ <a href="register.html">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>.</p>
            </div>
        </div>
        
        <div id="messages-content" style="display: none;">
            <div class="messages-container">
                <h1 class="messages-title">–°–æ–æ–±—â–µ–Ω–∏—è</h1>
                <div class="auth-info" style="margin-bottom: 20px; padding: 10px; background: #f0f8ff; border-radius: 5px;">
                    <p><strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:</strong></p>
                    <p id="auth-type-info"></p>
                </div>
                
                <ul class="message-list" id="message-list">
                    
                </ul>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 –í–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è. –ò—Ç–æ–≥–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ.</p>
    </footer>

    <script src="../scripts/common.js"></script>
    <script src="../scripts/auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const authCheck = document.getElementById('auth-check');
            const messagesContent = document.getElementById('messages-content');
            const authTypeInfo = document.getElementById('auth-type-info');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const currentUser = localStorage.getItem('currentUser');
            const rememberUser = localStorage.getItem('rememberUser');
            const sessionToken = sessionStorage.getItem('sessionToken');
            
            if (!currentUser || (!sessionToken && rememberUser !== 'true')) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                authCheck.style.display = 'block';
                messagesContent.style.display = 'none';
            } else {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                authCheck.style.display = 'none';
                messagesContent.style.display = 'block';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∏–ø –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                if (rememberUser === 'true') {
                    authTypeInfo.innerHTML = `
                        ‚úÖ –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—á–µ—Ä–µ–∑ "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è")<br>
                        üîÑ –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Å–µ—â–µ–Ω–∏–∏ —Å–∞–π—Ç–∞ –≤—ã –æ—Å—Ç–∞–Ω–µ—Ç–µ—Å—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º<br>
                        üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <strong>${currentUser}</strong>
                    `;
                } else {
                    authTypeInfo.innerHTML = `
                        üîì –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏<br>
                        ‚ö†Ô∏è –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–Ω–æ–≤–∞ –≤–æ–π—Ç–∏<br>
                        üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <strong>${currentUser}</strong>
                    `;
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
                loadMessages(currentUser);
            }
            
            function loadMessages(currentUser) {
                const messages = [
                    {
                        id: 1,
                        author: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                        date: new Date().toLocaleDateString('ru-RU'),
                        content: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à —Å–∞–π—Ç! –ú—ã —Ä–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å –∑–¥–µ—Å—å.'
                    },
                    {
                        id: 2,
                        author: '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä',
                        date: new Date(Date.now() - 86400000).toLocaleDateString('ru-RU'),
                        content: '–ù–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ —Ñ–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é.'
                    },
                    {
                        id: 3,
                        author: '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫',
                        date: new Date(Date.now() - 172800000).toLocaleDateString('ru-RU'),
                        content: '–ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –æ—à–∏–±–∫–∏ –Ω–∞ —Å–∞–π—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–æ–±—â–∏—Ç–µ –Ω–∞–º.'
                    },
                    {
                        id: 4,
                        author: currentUser,
                        date: new Date().toLocaleDateString('ru-RU'),
                        content: '–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –≤–∞—à–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.'
                    },
                    {
                        id: 5,
                        author: '–°–∏—Å—Ç–µ–º–∞',
                        date: new Date().toLocaleDateString('ru-RU'),
                        content: `–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${new Date().toLocaleDateString('ru-RU')}.`
                    }
                ];
                
                const messageList = document.getElementById('message-list');
                messageList.innerHTML = '';
                
                messages.forEach(message => {
                    const messageItem = document.createElement('li');
                    messageItem.className = 'message-item';
                    
                    messageItem.innerHTML = `
                        <div class="message-header">
                            <span class="message-author">${message.author}</span>
                            <span class="message-date">${message.date}</span>
                        </div>
                        <div class="message-content">${message.content}</div>
                    `;
                    
                    messageList.appendChild(messageItem);
                });
            }
        });
    </script>
</body>
</html>